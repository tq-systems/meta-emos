ssl_certificate			/cfglog/system/ssl/default.crt;
ssl_certificate_key		/cfglog/system/ssl/default.key;
ssl_ciphers			ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305;
ssl_prefer_server_ciphers	on;
ssl_protocols			TLSv1.2 TLSv1.3;
ssl_session_cache		shared:SSL:10m;
ssl_session_timeout		10m;

# explicitly set signature algorithms to disable RSA+SHA224
# according to openssl documentation the signature_schemes for TLS1.3 are lower case
# the signature algorithms for TLS1.2 however are upper case
# the command is case sensitive
ssl_conf_command SignatureAlgorithms rsa_pss_rsae_sha256:rsa_pss_rsae_sha384:rsa_pss_rsae_sha512:ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512:RSA+SHA256:RSA+SHA384:RSA+SHA512;

# restrict DH groups to secure ones only - exclude ffdhe2048 (too short), ffdhe6144 and ffdhe8192 (DoS vulnerability)
# only allow ffdhe3072 and ffdhe4096 as recommended by OWASP
ssl_conf_command Groups ffdhe3072:ffdhe4096:P-256:P-384:P-521;
