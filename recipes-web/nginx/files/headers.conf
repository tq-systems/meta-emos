# Include the following headers; note that add_header directives are only inherited
# if no other add_header is defined at the same level.

# Content-Security-Policy (CSP) – without 'unsafe-inline'/'unsafe-eval',
# covers font, media, worker, and connect sources. frame-ancestors prevents clickjacking.
add_header Content-Security-Policy "default-src 'self'; img-src 'self' data:; object-src 'none'; frame-ancestors 'self'; form-action 'self';" always;

# X-Frame-Options for older browsers (e.g., IE11) that don’t understand CSP 2+.
add_header X-Frame-Options "SAMEORIGIN" always;

# Referrer-Policy – only send referrer when origin remains the same.
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Prevent MIME sniffing.
add_header X-Content-Type-Options "nosniff" always;

# Permissions-Policy (formerly Feature-Policy) – block critical features.
# Here: disallow camera, microphone, geolocation, and FLoC (interest-cohort).
add_header Permissions-Policy "camera=(), microphone=(), geolocation=()" always;
